<div align="center">

# 📦 QQ 群备份

<i>☂️ 宜未雨而绸缪，毋临渴而掘井</i>

![License](https://img.shields.io/badge/license-AGPL--3.0-green?style=flat-square)
![Python](https://img.shields.io/badge/python-3.10+-blue?style=flat-square&logo=python&logoColor=white)
![AstrBot](https://img.shields.io/badge/framework-AstrBot-ff6b6b?style=flat-square)

</div>

## 📖 简介

一款为 [**AstrBot**](https://github.com/AstrBotDevs/AstrBot) 设计的 QQ 群数据备份插件。支持对群成员、群公告、群精华消息、群荣誉及相册等多种数据的全面监控与备份，提供便捷的导出、恢复以及基于备份数据的群友召回功能。

---

## ✨ 功能特性

* **📊 全面备份**: 支持备份群信息、群头像、群成员列表、群公告、群精华消息、群荣誉以及群相册。
* **📥 灵活导出**: 支持将备份数据导出为 Excel 表格，相册数据自动打包为 ZIP 压缩包发送。
* **🔄 数据恢复**: 支持一键恢复群名称、群头像、群成员名片、群公告及群相册。
* **📣 成员召回**: 支持基于老群备份数据，自动私聊召回成员，支持等级筛选及群名片发送。
* **🛠️ 增量更新**: 自动检测数据变化（如新成员入群、退群、群相册重命名等）并记录日志。
* **⚖️ 权限控制**: 支持 Bot 管理员及插件配置中指定的管理员使用。

---

## 📖 使用指南

⚠️ **所有管理指令仅限 Bot 管理员或插件配置的管理员使用**

### 📥 数据备份

**指令**: `/群备份 [群号]`
* 在群聊中直接使用可备份当前群。
* 私聊时需指定群号。

### 📤 数据导出

**指令**: `/群导出 [群号] [选项...]`
* **选项可选**: `群信息`、`群成员`、`群公告`、`群精华`、`群荣誉`、`群相册`。
* 若不指定选项，默认导出除“群相册”外的所有已备份项。
* 若包含“群相册”，插件将打包相册及已删除项目为 ZIP 发送。

### 🔄 数据恢复

**指令**: `/群恢复 [来源群号]`
* 在目标群中使用，将 `来源群号` 的备份数据恢复到当前群。
* **支持恢复**: 群名称、群头像、群成员名片、群公告、群相册。

### 📣 群友召回

**指令**: `/群友召回 [群等级] [群号] [消息文本]` 或 `/群友召回 [群号] [群等级] [消息文本]`
* 在新群中使用。
* 自动跳过已在当前群的成员。
* 自动从老群备份中筛选符合等级要求的成员（等级**大于或等于**指定的 `群等级` ）。
* 消息文本中支持使用 `@群号`（如 `@123456789`），会自动将其识别并转换为 `群名片` 发送。
>  **注意**: 必须对老群使用过群备份才能执行召回

### 🗑️ 删除备份

**指令**: `/删除群备份 [群号]`
* 删除指定群在本地的所有备份数据。

---

## ⚠️ 注意事项

* **环境要求**: 本插件**仅适用于 NapCat** 环境，建议使用最新版本的 NapCat 以获得最佳兼容性。
* **API 限制**: 受限于 NapCat API，本插件**无法备份**勾选了“发送给新成员”选项的群公告，以及**无法恢复视频**到群相册。

---

## ⏰ 定时备份

如果您需要定时自动执行备份任务，可以配合使用 [astrbot_plugin_reminder](https://github.com/Foolllll-J/astrbot_plugin_reminder) 插件。

**配置示例**:
使用 `reminder` 插件的 `/添加任务` 指令：
`/添加任务 每日群备份 0 3 * * * /群备份 123456789`
*(每天凌晨 3 点自动备份群 123456789)*

---

## 🔗 群文件备份

如果您有备份群文件的需求，可以尝试以下插件：

* 📂 [astrbot_plugin_GroupFS](https://github.com/Foolllll-J/astrbot_plugin_GroupFS): 支持备份群文件到**本地**。
* ☁️ [astrbot_plugin_openlistfile](https://github.com/Foolllll-J/astrbot_plugin_openlistfile): 支持备份群文件到**网盘**。

---

## 📝 更新日志

* **v1.1**
  * 新增 群员召回

* **v1.0**
  * 新增 群公告 恢复
  * 优化 群公告 备份与导出

* **v0.2**
  * 新增 群恢复
  * 优化 群导出

* **v0.1**
  * 实现基础的备份导出功能


---

## ❤️ 支持

* [AstrBot 帮助文档](https://astrbot.app)
* 如果您在使用中遇到问题，欢迎提交 [Issue](https://github.com/Foolllll-J/astrbot_plugin_group_backup/issues)。

---

<div align="center">

**如果本插件对你有帮助，欢迎点个 ⭐ Star 支持一下！**

</div>


